From 54676334cda4e002d2a66b429836ab0240bfab49 Mon Sep 17 00:00:00 2001
From: kevin <kevin.wang2004@hotmail.com>
Date: Tue, 7 Jan 2014 21:16:36 +0800
Subject: [PATCH] =?UTF-8?q?=E4=BF=AE=E6=AD=A3Makefile=E7=9B=B8=E5=85=B3?=
 =?UTF-8?q?=E6=96=87=E4=BB=B6?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 src/EVA11/Makefile                        |   7 +------
 src/EVA11/base/DEPS/ASMS/README           |   0
 src/EVA11/base/DEPS/JPGS/README           |   0
 src/EVA11/base/Makefile                   |  22 ++++++++++++++--------
 src/EVA11/base/OBJS/ASMS/Asm_Fun_Sets.s.o | Bin 1108 -> 0 bytes
 5 files changed, 15 insertions(+), 14 deletions(-)
 create mode 100644 src/EVA11/base/DEPS/ASMS/README
 create mode 100644 src/EVA11/base/DEPS/JPGS/README
 delete mode 100644 src/EVA11/base/OBJS/ASMS/Asm_Fun_Sets.s.o

diff --git a/src/EVA11/Makefile b/src/EVA11/Makefile
index 6c11a00..86ab0c8 100644
--- a/src/EVA11/Makefile
+++ b/src/EVA11/Makefile
@@ -18,12 +18,7 @@ all:
 	done
 .PHONY : clean 
 clean:
-	@set -e; \
-
+	@set -e;
 	@for dir in $(SUBDIRS); \
 		do $(MAKE) $(MAKECMDGOALS) -C $$dir ||  exit 1; \
 	done
-
-#for dir in $(SUBDIRS); \
-	do $(MAKE) clean -C $$dir all || exit 1; \
-done
diff --git a/src/EVA11/base/DEPS/ASMS/README b/src/EVA11/base/DEPS/ASMS/README
new file mode 100644
index 0000000..e69de29
diff --git a/src/EVA11/base/DEPS/JPGS/README b/src/EVA11/base/DEPS/JPGS/README
new file mode 100644
index 0000000..e69de29
diff --git a/src/EVA11/base/Makefile b/src/EVA11/base/Makefile
index 311190e..2abbbff 100644
--- a/src/EVA11/base/Makefile
+++ b/src/EVA11/base/Makefile
@@ -18,17 +18,20 @@ DYNAMICLIBS:=$(LIBS)
 STATICLIBS=$(THIRDLIB)
 endif
 
-TXTOBJS:=OBJS
-TXTDEPS:=DEPS
 TXTJPGS:=JPGS
 TXTASMS:=ASMS
+
+TXTOBJS:=OBJS
+TXTDEPS:=DEPS
 OBJS_DIR:=./$(TXTOBJS)/
 DEPS_DIR:=./$(TXTDEPS)/
 
+SRCS=
+SRCS+=$(wildcard *.cpp *.c)
+SRCS+=$(wildcard $(TXTJPGS)/*.jpg $(TXTJPGS)/*.png $(TXTJPGS)/*.gif)
+
 ifeq ($(COMPILE),arm9)
-SRCS:=$(wildcard *.cpp *.c $(TXTJPGS)/*.jpg $(TXTJPGS)/*.png $(TXTJPGS)/*.gif $(TXTASMS)/*.s)
-else
-SRCS:=$(wildcard *.cpp *.c $(TXTJPGS)/*.jpg $(TXTJPGS)/*.png $(TXTJPGS)/*.gif)
+SRCS+=$(wildcard $(TXTASMS)/*.s)
 endif
 
 OBJS:=$(SRCS:=.o)
@@ -49,7 +52,6 @@ endif
 
 endif
 
-
 all: $(DEPS) $(EXEC)
 
 $(DEPS_DIR)%.cpp.dep: %.cpp
@@ -67,7 +69,11 @@ $(DEPS_DIR)%.c.dep: %.c
 	$(RM) $@.tmp
 
 $(DEPS_DIR)$(TXTASMS)/%.s.dep: $(TXTASMS)/%.s
-	@set -e;
+	@set -e; \
+	$(RM) -rf $@.tmp; \
+	echo $^: $^ > $@.tmp; \
+	sed 's,\(.*\)\.s: *,$(TXTOBJS)/\1.o:,g' < $@.tmp > $@; \
+	$(RM) $@.tmp
 
 $(DEPS_DIR)$(TXTJPGS)/%.jpg.dep: $(TXTJPGS)/%.jpg
 	@set -e;
@@ -115,4 +121,4 @@ endif
 
 .PHONY: clean
 clean:
-	$(RM) -rf $(addprefix $(OBJS_DIR),*.o) $(addprefix $(OBJS_DIR),$(TXTJPGS)/*.o) $(addprefix $(DEPS_DIR),*.dep) $(EXEC) 
+	$(RM) -rf $(addprefix $(OBJS_DIR),*.o) $(addprefix $(OBJS_DIR),$(TXTJPGS)/*.o) $(addprefix $(OBJS_DIR),$(TXTASMS)/*.o) $(addprefix $(DEPS_DIR),*.dep) $(addprefix $(DEPS_DIR)ASMS/,*.dep) $(EXEC)
diff --git a/src/EVA11/base/OBJS/ASMS/Asm_Fun_Sets.s.o b/src/EVA11/base/OBJS/ASMS/Asm_Fun_Sets.s.o
deleted file mode 100644
index 28bcebcef3f8de47c9d1bafc6ffe609b38c56a01..0000000000000000000000000000000000000000
GIT binary patch
literal 0
HcmV?d00001

literal 1108
zcma)5&ubG=5T3W2w(F1L){BD0rcfbb^K5HC^cISSVpD=YKtZsZWTC+%E4#0tCwuVV
zQM`-&6Z``__$Tz}MMzTudJ{qLR=?SOv&Jgugvs~K%=hMPW+%^Ytlv~hk(i<q{fdYh
zSx~5?f)bq|kETED?$gKe7ezY*@&^YgZoT<@{_yg?)LtoP;1G02@`ZQnLvOD>^owst
z<iCdRj85*|8j6mukshL*rMXe)?;iZ2t*x$JFP2(ylq4pKy5)^pd0Ai8D;J9ueMPTO
z^$fZNVbJW5ng*Sy+@(p!Q>2q;Jrgv6CeCn6SR8h>37;C$?Z5=2n@K{t74>>yAGv;H
zLS5UqS58dOdQ7@{yRHLc;!bnhgb6?Vf7%>$JlaXC=lQ<0oS|U(Ip8tN85U6}*&Lr|
zod>@F=h%g_z0V;3&R!$YC1hCtFWnL}a)z65zj-Fsq;?Ila4vnabpffZA%Q!eNS<|P
zB>;+U23($v%irM-m{=1Xqa#V6heKb1$F1{Rd^pc;yx$K5%gBjIKZ*Z_ZvJ#x)%~p_
z_b(h#sPw%&%$upSzBv}>6vWN9Aj`TmF<wS}3ZKko0jJUJ6p%U3kYnC--XY!%j^}|q
z1NIsEcF6fnxYTJOpoKP7lis6hJHz^RH;o%n2djRk6*o+rCf52LgQMwPe4clM@xDd=
LoeutAFKql1i>iu(

-- 
1.8.5.2

